"use strict";const v=require("../StyleContext.js"),m=require("./useGlobalCache.js"),d=require("../util.js"),f=require("vue");function h(t){for(var e=0,n,o=0,c=t.length;c>=4;++o,c-=4)n=t.charCodeAt(o)&255|(t.charCodeAt(++o)&255)<<8|(t.charCodeAt(++o)&255)<<16|(t.charCodeAt(++o)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(c){case 3:e^=(t.charCodeAt(o+2)&255)<<16;case 2:e^=(t.charCodeAt(o+1)&255)<<8;case 1:e^=t.charCodeAt(o)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}const x={},y="css",a=new Map;function S(t){a.set(t,(a.get(t)||0)+1)}function A(t,e){typeof document<"u"&&document.querySelectorAll(`style[${v.ATTR_TOKEN}="${t}"]`).forEach(o=>{var c;o[v.CSS_IN_JS_INSTANCE]===e&&((c=o.parentNode)==null||c.removeChild(o))})}const p=0;function E(t,e){a.set(t,(a.get(t)||0)-1);const n=Array.from(a.keys()),o=n.filter(c=>(a.get(c)||0)<=0);n.length-o.length>p&&o.forEach(c=>{A(c,e),a.delete(c)})}const _=(t,e,n,o)=>{let u={...n==null?void 0:n.getDerivativeToken(t),...e};return o&&(u=o(u)),u};function b(t,e,n=f.ref({})){const o=v.useStyleInject(),c=f.computed(()=>Object.assign({},...e.value||[])),u=f.computed(()=>d.flattenToken(c.value)),C=f.computed(()=>{var s;return d.flattenToken(((s=n.value)==null?void 0:s.override)||x)});return m.default("token",f.computed(()=>{var s,r;return[((s=n.value)==null?void 0:s.salt)||"",(r=t.value)==null?void 0:r.id,u.value,C.value]}),()=>{const{salt:s="",override:r=x,formatToken:g,getComputedToken:k}=n.value||{},l=k?k(c.value,r,t.value):_(c.value,r,t.value,g),i=d.token2key(l,s);l._tokenKey=i,S(i);const T=`${y}-${h(i)}`;return l._hashId=T,[l,T]},s=>{var r;E(s[0]._tokenKey,(r=o.value)==null?void 0:r.cache.instanceId)})}exports.getComputedToken=_;exports.murmur2=h;exports.useCacheToken=b;
