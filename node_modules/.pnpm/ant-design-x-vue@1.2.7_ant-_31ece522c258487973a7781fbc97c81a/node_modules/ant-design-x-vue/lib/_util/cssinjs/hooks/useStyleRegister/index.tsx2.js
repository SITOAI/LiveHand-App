"use strict";const ye=require("../useCacheToken.tsx2.js"),$=require("../../StyleContext.js"),Se=require("../../util.js"),me=require("../useGlobalCache.js"),Y=require("../../../../vc-util/Dom/dynamicCSS.js"),V=require("vue"),pe=require("../../../../vc-util/Dom/canUseDom.js"),I=require("./cacheMapUtil.js");var ae={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},se="comm",ce="rule",ie="decl",_e="@import",ve="@keyframes",ge="@layer",oe=Math.abs,B=String.fromCharCode;function ue(e){return e.trim()}function K(e,t,n){return e.replace(t,n)}function be(e,t,n){return e.indexOf(t,n)}function q(e,t){return e.charCodeAt(t)|0}function M(e,t,n){return e.slice(t,n)}function E(e){return e.length}function ke(e){return e.length}function z(e,t){return t.push(e),e}var W=1,P=1,le=0,w=0,k=0,N="";function X(e,t,n,s,f,S,o,d){return{value:e,root:t,parent:n,type:s,props:f,children:S,line:W,column:P,length:o,return:"",siblings:d}}function Ce(){return k}function Ae(){return k=w>0?q(N,--w):0,P--,k===10&&(P=1,W--),k}function x(){return k=w<le?q(N,w++):0,P++,k===10&&(P=1,W++),k}function j(){return q(N,w)}function L(){return w}function F(e,t){return M(N,e,t)}function H(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Te(e){return W=P=1,le=E(N=e),w=0,[]}function we(e){return N="",e}function J(e){return ue(F(w-1,Q(e===91?e+2:e===40?e+1:e)))}function Re(e){for(;(k=j())&&k<33;)x();return H(e)>2||H(k)>3?"":" "}function xe(e,t){for(;--t&&x()&&!(k<48||k>102||k>57&&k<65||k>70&&k<97););return F(e,L()+(t<6&&j()==32&&x()==32))}function Q(e){for(;x();)switch(k){case e:return w;case 34:case 39:e!==34&&e!==39&&Q(k);break;case 40:e===41&&Q(e);break;case 92:x();break}return w}function Ee(e,t){for(;x()&&e+k!==57;)if(e+k===84&&j()===47)break;return"/*"+F(t,w-1)+"*"+B(e===47?e:x())}function $e(e){for(;!H(j());)x();return F(e,w)}function je(e){return we(G("",null,null,null,[""],e=Te(e),0,[0],e))}function G(e,t,n,s,f,S,o,d,A){for(var c=0,p=0,u=o,g=0,C=0,b=0,y=1,m=1,l=1,i=0,_="",a=f,v=S,h=s,r=_;m;)switch(b=i,i=x()){case 40:if(b!=108&&q(r,u-1)==58){be(r+=K(J(i),"&","&\f"),"&\f",oe(c?d[c-1]:0))!=-1&&(l=-1);break}case 34:case 39:case 91:r+=J(i);break;case 9:case 10:case 13:case 32:r+=Re(b);break;case 92:r+=xe(L()-1,7);continue;case 47:switch(j()){case 42:case 47:z(Oe(Ee(x(),L()),t,n,A),A),(H(b||1)==5||H(j()||1)==5)&&E(r)&&M(r,-1,void 0)!==" "&&(r+=" ");break;default:r+="/"}break;case 123*y:d[c++]=E(r)*l;case 125*y:case 59:case 0:switch(i){case 0:case 125:m=0;case 59+p:l==-1&&(r=K(r,/\f/g,"")),C>0&&(E(r)-u||y===0&&b===47)&&z(C>32?te(r+";",s,n,u-1,A):te(K(r," ","")+";",s,n,u-2,A),A);break;case 59:r+=";";default:if(z(h=ee(r,t,n,c,p,f,d,_,a=[],v=[],u,S),S),i===123)if(p===0)G(r,t,h,h,a,S,u,d,v);else switch(g===99&&q(r,3)===110?100:g){case 100:case 108:case 109:case 115:G(e,h,h,s&&z(ee(e,h,h,0,0,f,d,_,f,a=[],u,v),v),f,v,u,d,s?a:v);break;default:G(r,h,h,h,[""],v,0,d,v)}}c=p=C=0,y=l=1,_=r="",u=o;break;case 58:u=1+E(r),C=b;default:if(y<1){if(i==123)--y;else if(i==125&&y++==0&&Ae()==125)continue}switch(r+=B(i),i*y){case 38:l=p>0?1:(r+="\f",-1);break;case 44:d[c++]=(E(r)-1)*l,l=1;break;case 64:j()===45&&(r+=J(x())),g=j(),p=u=E(_=r+=$e(L())),i++;break;case 45:b===45&&E(r)==2&&(y=0)}}return S}function ee(e,t,n,s,f,S,o,d,A,c,p,u){for(var g=f-1,C=f===0?S:[""],b=ke(C),y=0,m=0,l=0;y<s;++y)for(var i=0,_=M(e,g+1,g=oe(m=o[y])),a=e;i<b;++i)(a=ue(m>0?C[i]+" "+_:K(_,/&\f/g,C[i])))&&(A[l++]=a);return X(e,t,n,f===0?ce:d,A,c,p,u)}function Oe(e,t,n,s){return X(e,t,n,se,B(Ce()),M(e,2,-2),0,s)}function te(e,t,n,s,f){return X(e,t,n,ie,M(e,0,s),M(e,s+1,-1),s,f)}function Z(e,t){for(var n="",s=0;s<e.length;s++)n+=t(e[s],s,e,t)||"";return n}function Ie(e,t,n,s){switch(e.type){case ge:if(e.children.length)break;case _e:case ie:return e.return=e.return||e.value;case se:return"";case ve:return e.return=e.value+"{"+Z(e.children,s)+"}";case ce:if(!E(e.value=e.props.join(",")))return""}return E(n=Z(e.children,s))?e.return=e.value+"{"+n+"}":""}const re=pe.default(),Me="_skip_check_",fe="_multi_value_";function U(e){return Z(je(e),Ie).replace(/\{%%%\:[^;];}/g,";")}function Pe(e){return typeof e=="object"&&e&&(Me in e||fe in e)}function Ne(e,t,n){if(!t)return e;const s=`.${t}`,f=n==="low"?`:where(${s})`:s;return e.split(",").map(o=>{var p;const d=o.trim().split(/\s+/);let A=d[0]||"";const c=((p=A.match(/^\w+/))==null?void 0:p[0])||"";return A=`${c}${f}${A.slice(c.length)}`,[A,...d.slice(1)].join(" ")}).join(",")}const ne=new Set,qe=void 0,D=(e,t={},{root:n,injectHash:s,parentSelectors:f}={root:!0,parentSelectors:[]})=>{const{hashId:S,layer:o,path:d,hashPriority:A,transformers:c=[],linters:p=[]}=t;let u="",g={};function C(m){const l=m.getName(S);if(!g[l]){const[i]=D(m.style,t,{root:!1,parentSelectors:f});g[l]=`@keyframes ${m.getName(S)}${i}`}}function b(m,l=[]){return m.forEach(i=>{Array.isArray(i)?b(i,l):i&&l.push(i)}),l}return b(Array.isArray(e)?e:[e]).forEach(m=>{const l=typeof m=="string"&&!n?{}:m;if(typeof l=="string")u+=`${l}
`;else if(l._keyframe)C(l);else{const i=c.reduce((_,a)=>{var v;return((v=a==null?void 0:a.visit)==null?void 0:v.call(a,_))||_},l);Object.keys(i).forEach(_=>{const a=i[_];if(typeof a=="object"&&a&&(_!=="animationName"||!a._keyframe)&&!Pe(a)){let v=!1,h=_.trim(),r=!1;(n||s)&&S?h.startsWith("@")?v=!0:h=Ne(_,S,A):n&&!S&&(h==="&"||h==="")&&(h="",r=!0);const[T,O]=D(a,t,{root:r,injectHash:v,parentSelectors:[...f,h]});g={...g,...O},u+=`${h}${T}`}else{let v=function(r,T){const O=r.replace(/[A-Z]/g,de=>`-${de.toLowerCase()}`);let R=T;!ae[r]&&typeof R=="number"&&R!==0&&(R=`${R}px`),r==="animationName"&&(T!=null&&T._keyframe)&&(C(T),R=T.getName(S)),u+=`${O}:${R};`};const h=(a==null?void 0:a.value)??a;typeof a=="object"&&(a!=null&&a[fe])&&Array.isArray(h)?h.forEach(r=>{v(_,r)}):v(_,h)}})}}),n?o&&Se.supportLayer():u=`{${u}}`,[u,g]};function he(e,t){return ye.murmur2(`${e.join("%")}${t}`)}function He(e,t){const n=$.useStyleInject(),s=V.computed(()=>{var o;return(o=e.value)==null?void 0:o.token._tokenKey}),f=V.computed(()=>{var o;return[s.value,...((o=e.value)==null?void 0:o.path)||[]]});let S=re;return me.default("style",f,()=>{const{path:o,hashId:d,layer:A,nonce:c,clientOnly:p,order:u=0}=e.value||{},g=f.value.join("|");if(I.existPath(g)){const[r,T]=I.getStyleAndHash(g);if(r)return[r,s.value,T,{},p,u]}const C=t(),{hashPriority:b,container:y,transformers:m,linters:l,cache:i}=n.value,[_,a]=D(C,{hashId:d,hashPriority:b,layer:A,path:o==null?void 0:o.join("-"),transformers:m,linters:l}),v=U(_),h=he(f.value,v);if(S){const r={mark:$.ATTR_MARK,prepend:"queue",attachTo:y},T=typeof c=="function"?c():c;T&&(r.csp={nonce:T});const O=Y.updateCSS(v,h,r);O[$.CSS_IN_JS_INSTANCE]=i.instanceId,O.setAttribute($.ATTR_TOKEN,s.value),Object.keys(a).forEach(R=>{ne.has(R)||(ne.add(R),Y.updateCSS(U(a[R]),`_effect-${R}`,{mark:$.ATTR_MARK,prepend:"queue",attachTo:y}))})}return[v,s.value,h,a,p,u]},([,,o],d)=>{(d||n.value.autoClear)&&re&&Y.removeCSS(o,{mark:$.ATTR_MARK})}),o=>o}function ze(e,t=!1){const n="style%",s=Array.from(e.cache.keys()).filter(c=>c.startsWith(n)),f={},S={};let o="";function d(c,p,u,g={}){const C={...g,[$.ATTR_TOKEN]:p,[$.ATTR_MARK]:u},b=Object.keys(C).map(y=>{const m=C[y];return m?`${y}="${m}"`:null}).filter(y=>y).join(" ");return t?c:`<style ${b}>${c}</style>`}return s.map(c=>{const p=c.slice(n.length).replace(/%/g,"|"),[u,g,C,b,y,m]=e.cache.get(c)[1];if(y)return null;const l={"data-vc-order":"prependQueue","data-vc-priority":`${m}`};let i=d(u,g,C,l);return S[p]=C,b&&Object.keys(b).forEach(a=>{f[a]||(f[a]=!0,i+=d(U(b[a]),g,`_effect-${a}`,l))}),[m,i]}).filter(c=>c).sort((c,p)=>c[0]-p[0]).forEach(([,c])=>{o+=c}),o+=d(`.${I.ATTR_CACHE_MAP}{content:"${I.serialize(S)}";}`,void 0,void 0,{[I.ATTR_CACHE_MAP]:I.ATTR_CACHE_MAP}),o}exports._cf=qe;exports.extractStyle=ze;exports.normalizeStyle=U;exports.parseStyle=D;exports.uniqueHash=he;exports.unitlessKeys=ae;exports.useStyleRegister=He;
